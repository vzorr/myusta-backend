image: node:18

pipelines:
  branches:
    dev:
      - step:
          name: ğŸš€ Deploy to Dev Server with PM2
          script:
            - echo "ğŸ” Connecting to server..."
            - >
              ssh -o StrictHostKeyChecking=no root@47.254.134.96 "
              echo 'ğŸ“ Step 1: Changing directory...' &&
              cd myusta-backend &&

              echo 'ğŸ“¥ Step 2: Pulling latest code...' &&
              git pull origin dev &&

              echo 'ğŸ“¦ Step 3: Installing dependencies...' &&
              npm install &&

              echo 'ğŸš€ Step 4: Restarting or starting PM2 process...' &&
              pm2 restart usta-app || pm2 start src/index.js --name usta-app &&

              echo 'âœ… Step 5: Deployment successful!'"
